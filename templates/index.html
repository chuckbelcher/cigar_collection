<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Cigar Collection</title>
  <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css' rel='stylesheet'>
</head>
<body class='bg-light'>
  <div class='container py-4'>
    <h1 class='mb-4'>Chuck's Cigar Collection</h1>
    <div class="d-flex justify-content-between align-items-center mb-3">
      {% if session.get('logged_in') %}
        <div class="text-success">✅ Logged in as admin</div>
        <a href="{{ url_for('logout') }}" class="btn btn-outline-danger btn-sm">Logout</a>
      {% else %}
        <div class="text-muted">Not logged in</div>
        <a href="{{ url_for('login') }}" class="btn btn-outline-primary btn-sm">Login</a>
      {% endif %}
    </div>
    
    <a href='/admin' class='btn btn-primary mb-3'>Add New Cigar</a>
    <a href='/archive' class='btn btn-secondary mb-3'>View Archive</a>
    <table class='table table-striped'>
      <thead><tr><th>Brand</th><th>Model</th><th>Location</th><th>Date</th><th>Qty</th><th>Rating</th><th></th></tr></thead>
      <tbody>
        {% for c in cigars %}
        <tr>
          <td>{{ c.brand }}</td>
          <td>{{ c.model }}</td>
          <td>{{ c.purchase_location }}</td>
          <td>{{ c.purchase_date.strftime('%Y-%m-%d') if c.purchase_date else '' }}</td>
          <td>{{ c.quantity }}</td>
          <td>{% for i in range(c.rating) %}⭐{% endfor %}</td>
          <td>
            <a href='/archive_toggle/{{ c.id }}' class='btn btn-sm btn-warning'>Archive</a>
            <a href='/delete/{{ c.id }}' class='btn btn-sm btn-danger'>Delete</a>
            <form action="{{ url_for('smoke', id=c.id) }}" method="post" style="display:inline;">
              <button type="submit" class="btn btn-secondary btn-sm">Smoked</button>
          </form>          
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</body>
</html>
